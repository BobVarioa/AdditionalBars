(function(e){"function"==typeof define&&define.amd?define(e):e()})(function(){'use strict';var Be=Math.max,We=Math.pow,xe=Math.min,Ee=Math.floor,qe=Math.abs;function e(e,n){return n={exports:{}},e(n,n.exports),n.exports}var _e="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,Re=e(function(i){(function(o,e){i.exports=e()})(_e,function(){function Re(o,e){function n(){this.constructor=o}_(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Fe(c,e,n,u){return new(n||(n=Promise))(function(i,o){function a(n){try{t(u.next(n))}catch(e){o(e)}}function r(n){try{t(u["throw"](n))}catch(e){o(e)}}function t(o){o.done?i(o.value):new n(function(e){e(o.value)}).then(a,r)}t((u=u.apply(c,e||[])).next())})}function He(t,e){function n(o){return function(e){return i([o,e])}}function i(a){if(o)throw new TypeError("Generator is already executing.");for(;m;)try{if(o=1,u&&(p=2&a[0]?u["return"]:a[0]?u["throw"]||((p=u["return"])&&p.call(u),0):u.next)&&!(p=p.call(u,a[1])).done)return p;switch((u=0,p)&&(a=[2&a[0],p.value]),a[0]){case 0:case 1:p=a;break;case 4:return m.label++,{value:a[1],done:!1};case 5:m.label++,u=a[1],a=[0];continue;case 7:a=m.ops.pop(),m.trys.pop();continue;default:if((p=m.trys,!(p=0<p.length&&p[p.length-1]))&&(6===a[0]||2===a[0])){m=0;continue}if(3===a[0]&&(!p||a[1]>p[0]&&a[1]<p[3])){m.label=a[1];break}if(6===a[0]&&m.label<p[1]){m.label=p[1],p=a;break}if(p&&m.label<p[2]){m.label=p[2],m.ops.push(a);break}p[2]&&m.ops.pop(),m.trys.pop();continue;}a=e.call(t,m)}catch(e){a=[6,e],u=0}finally{o=p=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var o,u,p,g,m={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return g={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g}function De(){for(var i=0,s=0,u=arguments.length;s<u;s++)i+=arguments[s].length;for(var o=Array(i),t=0,s=0;s<u;s++)for(var p=arguments[s],d=0,g=p.length;d<g;d++,t++)o[t]=p[d];return o}function Ne(n){return n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function a(r,s){var n=null===s[0],i=/(?:)/;null!==s[0]&&(i="string"==typeof s[0]?new RegExp(Ne(s[0]),"g"):s[0],!i.test(r)&&console.warn("Nothing to inject."));var d=/(\)[^{]*{)/,a=/(}?)$/;switch(s[2]){case"before":r=n?r.replace(d,"$1"+s[1]):r.replace(i,""+s[1]+s[0]);break;case"replace":r=n?s[1]:r.replace(i,s[1]);break;case"after":r=n?r.replace(a,s[1]+"$1"):r.replace(i,""+s[0]+s[1]);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}return r}function o(t,e,n,i,o){void 0===o&&(o={});var d=Function.apply(void 0,De(Object.keys(o),["return ("+a(t.toString(),[e,n,i])+")"])).apply(void 0,Object.values(o));return d.prototype=t.prototype,d}function r(t,e,n){void 0===n&&(n={});for(var u,p=t.toString(),g=0,m=e;g<m.length;g++)u=m[g],p=a(p,u);var d=Function.apply(void 0,De(Object.keys(n),["return ("+p+")"])).apply(void 0,Object.values(n));return d.prototype=t.prototype,d}function Ye(i,e){for(var n in e)i[n]=e[n]}function c(n){return n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()}function u(i,e){return i.hasOwnProperty(e)}function t(t){for(var s,d=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],i="",c=0,u=d;c<u.length;c++)for(s=u[c];t>=s[0];)i+=s[1],t-=s[0];return i}function p(n){switch(n){case"mod":return{achievements:{},buildings:{},upgrades:{}};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!");}}function s(){return{mods:{},foreign:p("mod"),saveVer:1,dragon:p("dragon")}}function i(){Ue.save=D=s()}function ze(n){return D.foreign.buildings[n.name]||p("building")}function d(c){var e=c.amount,n=c.bought,i=c.free,o=c.totalCookies,a=c.level,r=c.muted,t=c.minigameSave,s=c.name;D.foreign.buildings[s]={amount:e,bought:n,free:i,totalCookies:o,level:a,muted:r,minigameSave:t}}function g(n){return D.foreign.upgrades[n.name]||p("upgrade")}function e(n){D.foreign.upgrades[n.name]={unlocked:!!n.unlocked,bought:!!n.bought}}function m(n){return D.foreign.achievements[n.name]||p("achievement")}function n(n){D.foreign.achievements[n.name]={won:!!n.won}}function h(){"sync"!==D.dragon.level&&D.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=D.dragon.level),"sync"!==D.dragon.auras[0]&&D.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=D.dragon.auras[0]),"sync"!==D.dragon.auras[1]&&D.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=D.dragon.auras[1])}function k(){for(var c,u=0,p=Ue.customBuildings;u<p.length;u++)c=p[u],Ye(c,ze(c));for(var i,k=0,b=Ue.customUpgrades;k<b.length;k++)i=b[k],Ye(i,g(i)),i.bought&&Game.CountsAsUpgradeOwned(i.pool)&&Game.UpgradesOwned++;for(var r,v=0,f=Ue.customAchievements;v<f.length;v++)r=f[v],Ye(r,m(r)),r.won&&Game.CountsAsAchievementOwned(r.pool)&&Game.AchievementsOwned++;h()}function b(){for(var c,u=0,p=Ue.customBuildings;u<p.length;u++)c=p[u],d(c);for(var i,g=0,m=Ue.customUpgrades;g<m.length;g++)i=m[g],e(i);for(var r,h=0,k=Ue.customAchievements;h<k.length;h++)r=k[h],n(r)}function v(a){var e=s();if("object"!=typeof a||null===a)return e;if(!u(a,"saveVer")||"number"!=typeof a.saveVer||1<a.saveVer)return e;if(e.foreign=u(a,"foreign")?function(c){var e=p("mod");if("object"!=typeof c||null===c)return e;if(u(c,"buildings")&&"object"==typeof c.buildings&&null!==c.buildings)for(var n in c.buildings){var i=c.buildings[n];if("object"==typeof i&&null!==i)for(var o in e.buildings[n]=p("building"),i)typeof e.buildings[n][o]==typeof i[o]&&(e.buildings[n][o]=i[o])}if(u(c,"upgrades")&&"object"==typeof c.upgrades&&null!==c.upgrades)for(var g in c.upgrades){var r=c.upgrades[g];if("object"==typeof r&&null!==r)for(var o in e.upgrades[g]=p("upgrade"),e.upgrades[g])typeof e.upgrades[g][o]==typeof r[o]&&(e.upgrades[g][o]=r[o])}if(u(c,"achievements")&&"object"==typeof c.achievements&&null!==c.achievements)for(var t in c.achievements){var s=c.achievements[t];if("object"==typeof s&&null!==s)for(var o in e.achievements[t]=p("achievement"),e.achievements[t])typeof e.achievements[t][o]==typeof s[o]&&(e.achievements[t][o]=s[o])}return e}(a.foreign):p("mod"),u(a,"dragon")&&"object"==typeof a.dragon&&null!==a.dragon&&(u(a.dragon,"level")&&("number"==typeof a.dragon.level||"sync"===a.dragon.level)&&(e.dragon.level=a.dragon.level),u(a.dragon,"auras")&&a.dragon.auras instanceof Array))for(var n in a.dragon.auras){var o=a.dragon.auras[n];("number"==typeof o||"sync"===o)&&(e.dragon.auras[n]=o)}return e}function f(o){var e;try{e=JSON.parse(o)}catch(e){""!==o&&console.warn("CPPKIES: Found invalid save, creating new one..."),i()}D=Ue.save=v(e),k()}function y(){return b(),JSON.stringify(D)}function w(i,e){N[i]=e}function L(n){if(Y.includes(n))throw new Error("Recursive alias");return(Y.push(n),n in N)?L(N[n]):(Y=[],n)}function S(o){return new Promise(function(e){var n=new Image;n.addEventListener("load",function(){e(n)}),n.crossOrigin="Anonymous",n.src=o})}function j(i){return new Promise(function(o){i.canvas.toBlob(function(n){o(URL.createObjectURL(n))})})}function C(g,t,e,n,o,a){return new Promise(function(i){e[0]instanceof Array||(e=[e]),e=e;var r={};for(var s in e)for(var d in e[s])if(e[s][d]){if(e[s][d]=e[s][d].toString().toLowerCase(),!(e[s][d]in t))throw new Error("Invalid icon name");r[e[s][d]]=[parseInt(d),parseInt(s)]}var c=document.createElement("canvas").getContext("2d"),u=new Image;u.addEventListener("load",function(){for(var s in c.canvas.width=o[0],c.canvas.height=o[1],r)c.drawImage(u,r[s][0]*n[0],r[s][1]*n[1],n[0],n[1],t[s][0]*n[0],t[s][1]*n[1],n[0],n[1]);var e,p=function(){j(c).then(i)};a&&(e=a(c)),e instanceof Promise?e.then(p):p()}),u.crossOrigin="Anonymous",u.src=g})}function A(n){return n=De(n),(void 0===n[2]||null===n[2])&&(n[2]=Ue.iconLink),n[2]=L(n[2]),n}function O(a){var e=new R,n=[new F("tooltip",function(){a.tooltip=o(o(a.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new F("buy",function(){a.buy=o(a.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new F("levelUp",function(){a.levelUp=o(a.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:a})})];n.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Ue.hooks.on("buildingCps",function(n){return{building:n.building,cps:Game.Objects[n.building]===a?e.emit("cps",n.cps):n.cps}}),Z[a.name]=e}function B(){for(var o,a=0,r=Game.ObjectsById;a<r.length;a++)o=r[a],Z[o.name]||O(o)}function T(n){return"fortune"===n.tier}function U(i){for(var e,r=1,t=1;t<=i;t++)r+=null!==(e=le[t])&&void 0!==e?e:le["default"];return 9*E(10,r)}function P(){Ue.on("getIcon",function(a){var r=a.icon,e=a.type,n=a.tier;return Ue.customTiers.forEach(function(i){i.keyName===n.toString()&&i.iconLink&&(r[2]=i.iconLink)}),{icon:r,type:e,tier:n}}),Ue.on("getIcon",function(a){var r=a.icon,n=a.type,e=a.tier;return Ue.customBuildings.forEach(function(i){i.name===n&&i.iconLink&&(r[2]=i.iconLink)}),{icon:r,tier:e,type:n}}),Ue.on("getIcon",function(a){var e=a.icon,n=a.type,i=a.tier;return void 0!==e[2]&&null!==e[2]||u(Game.Tiers[i.toString()],"iconLink")||(e[2]=""),{icon:e,tier:i,type:n}}),Ue.on("preSave",function(){if(0!==Game.dragonAura&&(D.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(D.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof je&&(D.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof je&&(D.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Ae||Game.dragonLevel>=H)for(D.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Ae||Game.dragonLevel>=H;)Game.dragonLevel--}),Ue.on("postSave",function(){"sync"!==D.dragon.auras[0]&&Game.dragonAuras[D.dragon.auras[0]]&&(Game.dragonAura=D.dragon.auras[0]),"sync"!==D.dragon.auras[1]&&Game.dragonAuras[D.dragon.auras[1]]&&(Game.dragonAura2=D.dragon.auras[1]),"sync"!==D.dragon.level&&Game.dragonLevels[D.dragon.level]&&(Game.dragonLevel=D.dragon.level)}),Ue.on("reset",function(){D.dragon.auras=["sync","sync"],D.dragon.level="sync"}),Ue.on("specialPic",function(o){var e,a=Game.dragonLevels[Game.dragonLevel];return"dragon"===o.tab&&a instanceof Ae&&(o.pic=null!==(e=a.picLink)&&void 0!==e?e:o.pic),o})}var M,I=qe,G=Ee,x=xe,E=We,q=Be,_=function(i,e){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,e){i.__proto__=e}||function(o,e){for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n])},_(i,e)},R=function(){function n(){this._events={}}return n.prototype.on=function(i,e){this._events[i]?this._events[i].push(e):this._events[i]=[e]},n.prototype.once=function(a,e){var n=this;this.on(a,function(i){return n.off(a,e),e(i)})},n.prototype.off=function(i,e){this._events[i].splice(this._events[i].indexOf(e),1)},n.prototype.emit=function(s){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var d=e[0];this._events[s]||(this._events[s]=[]);for(var c,u=0,p=this._events[s];u<p.length;u++)c=p[u],d=c(d);return d},n.prototype.constEmit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._events[t]||(this._events[t]=[]);for(var s,d=0,c=this._events[t];d<c.length;d++)s=c[d],s(e[0])},n}(),F=function(){return function(i,e){this.value=i,this.func=e}}(),H=Game.dragonLevels.length+0,D=s(),N={},Y=[],V={},z={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},X={},$={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},Z={},ee=[],ne=function(h){function e(n,e,i,o,a,r,t,s,d,c){var u,p,y=this;if(Game.Objects[n])throw new Error("Can't create building, \""+n+"\" is already used as a building name");0!==o[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==a[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),y=h.call(this,n,e,i,a[1],o[0],r,0,t,s)||this,ee.push(y),Z[n]||O(y);var w=function(o){if(0>=parseInt(o))return"continue";var a=Game.ObjectsById[o];if(a.canvas=l("rowCanvas"+o),!a.canvas)return"continue";if(a.ctx=a.canvas.getContext("2d"),a.canvas.addEventListener("mouseover",function(){a.mouseOn=!0}),a.canvas.addEventListener("mouseout",function(){a.mouseOn=!1}),a.canvas.addEventListener("mousemove",function(n){var i=a.canvas.getBoundingClientRect();a.mousePos[0]=n.pageX-i.left,a.mousePos[1]=n.pageY-i.top}),a.minigame&&a.minigameLoaded){var e=a.minigame.save();a.minigame.launch(),a.minigame.load(e)}};for(var b in Game.ObjectsById)w(b);y.buildingLink=null!==(u=a[2])&&void 0!==u?u:Ue.buildingLink,y.iconLink=L(null!==(p=o[2])&&void 0!==p?p:Ue.iconLink),d&&(Game.foolObjects[n]=d),c&&(Game.goldenCookieBuildingBuffs[n]=c),y.iconLink&&Z[y.name].on("tooltip",function(n){return y.locked?n:n.replace("background-position","background-image:url("+y.iconLink+");background-position")}),Game.BuildStore(),y.buildingLink&&Ue.hooks.on("buildStore",function(){l("productIcon"+y.id).style.backgroundImage="url("+y.buildingLink+")",l("productIconOff"+y.id).style.backgroundImage="url("+y.buildingLink+")"}),Game.BuildStore(),y.canvas=l("rowCanvas"+y.id),y.ctx=y.canvas.getContext("2d"),y.pics=[];var S=document.createElement("div");S.className="tinyProductIcon",S.id="mutedProduct"+y.id,S.style.display="none",y.buildingLink&&(S.style.backgroundImage="url("+y.buildingLink+")"),S.style.backgroundPositionX="-"+o[0]+"px",S.style.backgroundPositionY="-"+o[1]+"px",S.addEventListener("click",function(){y.mute(0),window.PlaySound(y.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(y.canvas,"mouseover",function(){y.mouseOn=!0}),window.AddEvent(y.canvas,"mouseout",function(){y.mouseOn=!1}),y.canvas.addEventListener("mousemove",function(i){var n=y.canvas.getBoundingClientRect();y.mousePos[0]=i.pageX-n.left,y.mousePos[1]=i.pageY-n.top}),l("buildingsMute").appendChild(S);var f=ze(y);for(var b in f)y[b]=f[b];return Game.recalculateGains=1,y}return Re(e,h),e}(Game.Object),ie=[],oe=function(u){function e(n,e,i,o,a){void 0===a&&(a=function(){});var r=u.call(this,n,"function"==typeof e?"":e,"function"==typeof i?0:i,"function"==typeof o?[0,0]:A(o),a)||this;"function"==typeof e&&(r.descFunc=e),"function"==typeof i&&(r.priceFunc=i),"function"==typeof o&&(r.iconFunction=function(){return A(o())}),ie.push(r);var s=g(r);for(var d in s)r[d]=s[d];return Game.upgradesToRebuild=1,r.bought&&Game.CountsAsUpgradeOwned(r.pool)&&Game.UpgradesOwned++,r}return Re(e,u),e}(Game.Upgrade),ae=function(c){function e(n,e,i,o,a,r,u){void 0===r&&(r=["Legacy"]),void 0===u&&(u=function(){});var p=c.call(this,n,e,i,o,u)||this;return p.pool="prestige",p.posX=a[0],p.posY=a[1],p.parents=r.map(function(n){return Game.Upgrades[n]||Game.UpgradesById[n]}),Game.PrestigeUpgrades.push(p),Game.UpgradePositions[p.id]=a,p}return Re(e,c),e}(oe),re=function(t){function e(n,e,i,s){var d=this;return"string"==typeof i&&(i=Game.Objects[i]),d=t.call(this,n,c(i.plural)+" are <b>twice</b> as efficient.<q>"+e+"</q>",i.basePrice*Game.Tiers[s].price,Game.GetIcon(i.name,s))||this,Game.SetTier(i.name,s),d.buildingTie1=i,T(d)&&(d.order=19e3,i.fortune=d),isNaN(parseInt(s.toString()))||(s=parseInt(s.toString())),"number"==typeof s&&(d.order=100*(i.id+1)+d.id/1e3,d.order-=75*q(0,x(i.id-4,3)),8<=i.id&&(d.order-=75)),"fortune"===s&&Game.Tiers[s].upgrades.push(d),i.buyFunction.apply(i),d}return Re(e,t),e}(oe),te=function(a){function e(n,e,i,d){var u=this;if(d){if(!d.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+d+"\", URL must end with .png");d=d.substring(0,d.length-4)}"string"==typeof i&&(i=Game.Objects[i]);var p=i.id-1;return 1===p?p="grandma":p+=" grandmas",u=a.call(this,n,"Grandmas are <b>twice</b> as efficient. "+c(i.plural)+" gain <b>+1% CpS</b> per "+p+".<q>"+e+"</q>",i.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,i.grandma=u,u.buildingTie=i,u.order=250+u.id/1e3,12<=i.id&&(u.order+=5),Game.GrandmaSynergies.push(u.name),d&&Ue.hooks.on("grandmaPic",function(n){return u.bought?De(n,[d]):n}),Game.Objects.Grandma.redraw(),i.buyFunction.apply(i),u}return Re(e,a),e}(oe),se=function(u){function e(n,e,i,p,g){var r=this;"string"==typeof i&&(i=Game.Objects[i]),"string"==typeof p&&(p=Game.Objects[p]);var m=Game.GetIcon(i.name,g);if(i.basePrice>p.basePrice){var s=i;i=p,p=s}return r=u.call(this,n,c(i.plural)+" gain <b>+5% CpS</b> per "+p.name.toLowerCase()+".<br>"+c(p.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+i.name.toLowerCase()+".<q>"+e+"</q>",(10*i.basePrice+1*p.basePrice)*Game.Tiers[g].price,m)||this,r.tier=g,r.buildingTie1=i,r.buildingTie2=p,r.order=5e3+r.id/1e3,i.synergies.push(r),p.synergies.push(r),Game.Tiers[g].upgrades.push(r),Game.RebuildUpgrades(),i.buyFunction.apply(i),r}return Re(e,u),e}(oe),de=[5,7,8,9,10],ce=function(d){function e(n,e,i,o){void 0===o&&(o=20);var c=this,u=Game.Objects.Cursor,t=parseInt(i.toString());return c=d.call(this,n,"Multiplies the gain from Thousand fingers by <b>"+o+"</b>.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(t)?u.basePrice*Game.Tiers[i].price:E(10,de[x(t-4,de.length-1)]+3*q(t-8,0)),Game.GetIcon(u.name,i))||this,c.tier=i,c.pool="",c.order=100+c.id/1e3,Ue.on("cursorFingerMult",function(n){return c.bought?n*o:n}),Game.Tiers[i].special||isNaN(t)||Ue.buildingHooks.Cursor.on("buy",function(){u.amount>=(4===t?25:50*(t-4))&&Game.Unlock(c.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(c),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),c}return Re(e,d),e}(oe),le={1:5,2:4,4:4,default:3},ue=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],pe=function(d){function e(n,e,i,o,c,r){void 0===o&&(o=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:ue[(parseInt(i.toString())-1)%(ue.length-1)]),void 0===r&&(r=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:1===i?.5:i-1);var u=d.call(this,n,"You gain <b>more CpS</b> the more milk you have.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null!==c&&void 0!==c?c:0:U(i),Game.GetIcon("Kitten",i))||this;return u.tier=i,u.kitten=!0,u.pool="",null===o&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[i].special||isNaN(parseInt(i.toString())))&&void 0===c&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==r&&Ue.on("logic",function(){Game.milkProgress>=r&&Game.Unlock(u.name)}),u.order=2e4+u.id/1e3,null!==o&&Ue.on("rawCpsMult",function(i){var e=u.bought?1+Game.milkProgress*o*Ue.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=e,i*e}),Game.UpgradesByPool.kitten.push(u),"fortune"===i&&Game.Tiers[i].upgrades.push(u),u}return Re(e,d),e}(oe),ge=function(s){function e(n,e,i,o){void 0===o&&(o=1);var d=s.call(this,n,"Clicking gains <b>+"+o+"% of your CpS</b>.<q>"+e+"</q>",E(10,3+2*parseInt(i.toString())),Game.GetIcon("Mouse",i))||this;d.tier=i,d.pool="";var r=parseInt(i.toString());return d.order=150+d.id/1e3,Ue.on("cpcAdd",function(n){return d.bought?n+Game.cookiesPs*o/100:n}),Game.Tiers[i].special||isNaN(r)||Ue.on("check",function(){Game.handmadeCookies>=E(10,1+2*r)&&Game.Unlock(d.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(d),d}return Re(e,s),e}(oe),me=function(u){function e(n,e,i,o,a,r,t){var s,p=u.call(this,n,"Cookie production multiplier <b>+"+Beautify("function"==typeof a?a():a,1)+"%</b>.<q>"+e+"</q>",i,o)||this;return p.power=a,p.pool="cookie",p.order=(null!==(s=null!==t&&void 0!==t?t:Ue.cookieOrder)&&void 0!==s?s:10020)+p.id/1e3,p.unlockAt={name:n,cookies:("function"==typeof i?i():i)/20,require:null===r||void 0===r?void 0:r.require,season:null===r||void 0===r?void 0:r.season},Game.UnlockAt.push(p.unlockAt),Game.UpgradesByPool.cookie.push(p),Game.cookieUpgrades.push(p),p}return Re(e,u),e}(oe),he=[],ke=function(){return function(u,e,n,i,p,g,m,h,k){void 0===i&&(i=!1),void 0===p&&(p="auto"),void 0===g&&(g=null),void 0===m&&(m=null),void 0===h&&(h=null),void 0===k&&(k="auto");var b;this.name=u,this.color=n,this.special=i,this.keyName="auto"===k?i?u:(Object.keys(Game.Tiers).filter(function(n){return!isNaN(parseInt(n))}).length+1).toString():k,null===g&&(this.unlock=-1),"number"==typeof g&&(this.unlock=g),(!1===i&&null===g||"auto"===g)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof m&&(this.achievUnlock=m),(!1===i&&null===m||"auto"===m)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),h&&(this.req=h),this.price="auto"===p?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(n){return!isNaN(parseInt(n))}).length.toString()].price:p,this.iconRow=e[1],this.iconLink=L(null!==(b=e[2])&&void 0!==b?b:Ue.iconLink),Game.Tiers[this.keyName]=this,he.push(this)}}(),be=[],ve=function(r){function e(n,e,i){var o=r.call(this,n,e,A(i))||this;return Ye(o,m(o)),be.push(o),o.won&&Game.CountsAsAchievementOwned(o.pool)&&Game.AchievementsOwned++,o}return Re(e,r),e}(Game.Achievement),fe=function(t){function e(n,e,i,o){void 0===o&&(o=E(10,G(1.5*Game.BankAchievements.length+2)));var s=t.call(this,n,"Bake <b>"+toFixed(o)+"</b> cookie"+(1===I(o)?"":"s")+" in one ascension."+(i?"<q>"+i+"</q>":""),e)||this;return s.treshold=o,s.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(s),s}return Re(e,t),e}(ve),ye=function(t){function e(n,e,i,o){void 0===o&&(o=E(10,G(1.2*Game.BankAchievements.length)));var s=t.call(this,n,"Bake <b>"+toFixed(o)+"</b> cookie"+(1===I(o)?"":"s")+" per second."+(i?"<q>"+i+"</q>":""),e)||this;return s.treshold=o,s.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(s),s}return Re(e,t),e}(ve),Ce=function(c){function e(n,e,i,o){var a=this,u="object"==typeof i?i:Game.Objects[i],t=null,p=-1;if(0===u.id){switch(o){case"cursor2":t=[0,6],p=2;break;case"cursor50":t=[1,6],p=50;break;default:if(0>=Game.Tiers[o].achievUnlock){console.warn("Tier has invalid unlock amount");break}p=1===o?1:2*Game.Tiers[o].achievUnlock;}Ue.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=p&&Game.Win(a.name)})}else p=Game.Tiers[o].achievUnlock;return a=c.call(this,n,"Have <b>"+p+"</b> "+(1===I(p)?u.single:u.plural)+"."+(e?"<q>"+e+"</q>":""),null!==t&&void 0!==t?t:Game.GetIcon(u.name,o))||this,Game.SetTier(u.name,"cursor2"===o||"cursor50"===o?1:o),u.tieredAchievs[o]=a,a.buildingTie=u,a.order=1e3+100*u.id+a.id/1e3,a.order-=75*q(0,x(u.id-4,3)),8<=u.id&&(a.order-=75),0===u.id&&(a.order+=50),a}return Re(e,c),e}(ve),we=function(c){function e(n,e,u,o,a){var r=this;"string"==typeof e&&(e=Game.Objects[e]);var p=[e.iconColumn,21+u,e instanceof ne?e.iconLink:void 0],s=E(10,12+e.id+(null!==a&&void 0!==a?a:0)+7*(u-1));return r=c.call(this,n,"Make <b>"+toFixed(s)+"</b> cookies just from "+e.plural+"."+(o?"<q>"+o+"</q>":""),p)||this,r.order=1020+100*e.id+r.id/1e3,r.order-=75*q(0,x(e.id-4,3)),8<=e.id&&(r.order-=75),0===e.id&&(r.order+=50),e.productionAchievs.push({pow:s,achiev:r}),r}return Re(e,c),e}(ve),Le=function(t){function e(n,e,s){var o=this;"string"==typeof e&&(e=Game.Objects[e]);var d=[e.iconColumn,26,e instanceof ne?e.iconLink:void 0];return o=t.call(this,n,"Reach level <b>10</b> "+e.plural+"."+(s?"<q>"+s+"</q>":""),d)||this,o.order=1020+100*e.id+o.id/1e3,o.order-=75*q(0,x(e.id-4,3)),8<=e.id&&(o.order-=75),0===e.id&&(o.order+=50),e.levelAchiev10=o,o}return Re(e,t),e}(ve),Se=function(t){function e(n,e,i){var o=this,s=parseInt(e.toString());return o=t.call(this,n,"Make <b>"+toFixed(E(10,1+2*s))+"</b> cookies from clicking."+(i?"<q>"+i+"</q>":""),Game.GetIcon("Mouse",e))||this,o.pool="normal",o.tier=e,o.order=1e3+o.id/1e3,Game.Tiers[e].special||isNaN(s)||Ue.on("check",function(){Game.handmadeCookies>=E(10,1+2*s)&&Game.Win(o.name)}),o}return Re(e,t),e}(ve),je=function(){function n(o,e,n){this.name=o,this.desc=e,"string"==typeof n&&(n=Game.Objects[n]),this.pic=n instanceof Game.Object?A([n.iconColumn,25,n instanceof ne?n.iconLink:void 0]):n,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==D.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=D.dragon.auras[0]&&(Game.dragonAura=D.dragon.auras[0]),"sync"!==D.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=D.dragon.auras[1]&&(Game.dragonAura2=D.dragon.auras[1])}return n}(),Ae=function(){function c(e,n,i,o,a,r,t){void 0===t&&(t=Game.dragonLevels.length-3),this.buy=a,this.picY=0;var u=Game.dragonLevels[t-1];this.name=null!==e&&void 0!==e?e:u.name,this.action=n,this.costStr="string"==typeof i?function(){return i}:i,this.cost=o,r?(this.pic=r[0],this.picY=r[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=r[2]):(this.pic=u.pic,u instanceof c&&(this.picY=u.picY,this.picLink=u.picLink)),Game.dragonLevels.splice(t,0,this),"sync"!==D.dragon.level&&Game.dragonLevels.length>=D.dragon.level&&(Game.dragonLevel=D.dragon.level)}return c}(),Oe=function(r){function e(n,e,i){var t=this;return"string"==typeof i&&(i=Game.Objects[i]),t=r.call(this,null,"Train "+n+"<br/><small>Aura : "+e+"</small>","100 "+i.plural,function(){return 100<=i.amount},function(){return i.sacrifice(100)})||this,t}return Re(e,r),e}(Ae),Te=function(){return function(a,e,n,i){if(void 0===i&&(i=!1),this.name=a,this.pic=n,this.special=i,!n.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+n+"\", the URL must end with .png!");i||(this.name="Rank "+t(Game.Milks.length+1)+" - "+a),this.pic=n.substr(0,n.length-4),A(e),this.icon=[e[0],e[1]],this.iconLink=e[2],i?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)}}(),Ue={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:Z,buildingHooksById:[],hookAllBuildings:B,customBuildings:ee,customUpgrades:ie,customTiers:he,save:D,onLoad:[],Building:ne,Upgrade:oe,TieredUpgrade:re,Tier:ke,HeavenlyUpgrade:ae,GrandmaSynergy:te,SynergyUpgrade:se,CursorUpgrade:ce,KittenUpgrade:pe,MouseUpgrade:ge,CookieUpgrade:me,Achievement:ve,CpsAchievement:ye,BankAchievement:fe,TieredAchievement:Ce,ProductionAchievement:we,Level10Achievement:Le,MouseAchievement:Se,customAchievements:be,DragonAura:je,DragonLevel:Ae,DragonAuraLevel:Oe,Milk:Te,injectCode:o,injectCodes:r,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(n){return Game.GetTieredCpsMult(n)*Game.magicCpS(n.name)*n.baseCps},icons:{relinkColumn:function(u,e,o,a){return void 0===a&&(a=!1),Fe(this,void 0,void 0,function(){var r,i,i,t,p;return He(this,function(n){switch(n.label){case 0:for(i in void 0===o&&(!V[u]&&(V[u]=0),o=V[u]++),r={},z)r[i]=[o,z[i][1]];for(i in Game.Tiers)r[Game.Tiers[i].name.toLowerCase()]=r[i.toString()]=[o,Game.Tiers[i].iconRow];return t=w,p=[u],[4,C(a?L(u):u,r,e,[48,48],[48*(o+1),48*(Object.values(r).reduce(function(i,e){return q(i,e[1])},-Infinity)+1)],function(e){return new Promise(function(n){if(L(u)!==u){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),n()}),i.src=L(u),i.crossOrigin="Anonymous"}else n()})})];case 1:return t.apply(void 0,p.concat([n.sent()])),[2];}})})},relinkRow:function(u,e,o,a){return void 0===a&&(a=!1),Fe(this,void 0,void 0,function(){var r,i,i,t,p;return He(this,function(n){switch(n.label){case 0:for(i in void 0===o&&(!X[u]&&(X[u]=0),o=X[u]++),r={},$)r[i]=[$[i][0],o];for(i in Game.ObjectsById)r[Game.ObjectsById[i].single.toLowerCase()]=r[i]=[Game.ObjectsById[i].iconColumn,o];return t=w,p=[u],[4,C(a?L(u):u,r,e,[48,48],[48*(Object.values(r).reduce(function(i,e){return q(i,e[0])},-Infinity)+1),48*(o+1)],function(e){return new Promise(function(n){if(L(u)!==u){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),n()}),i.src=L(u),i.crossOrigin="Anonymous"}else n()})})];case 1:return t.apply(void 0,p.concat([n.sent()])),[2];}})})},patchIconsheet:function(y,e,i){var A;return void 0===i&&(i=!0),Fe(this,void 0,void 0,function(){var a,r,B,O,T,U,P,M,I,G,W,x,E,q,_;return He(this,function(n){switch(n.label){case 0:return a=document.createElement("canvas").getContext("2d"),[4,S(i?L(y):y)];case 1:for(r=n.sent(),B=[r.width,r.height],O=0,T=e;O<T.length;O++)U=T[O],48*U[0][0]>B[0]&&(B[0]=48*U[0][0]),48*U[0][1]>B[1]&&(B[1]=48*U[0][1]);a.canvas.width=B[0],a.canvas.height=B[1],a.drawImage(r,0,0),P={},M=0,I=e,n.label=2;case 2:return M<I.length?(G=I[M],W=L((null!==(A=G[1][2])&&void 0!==A?A:Ue.iconLink)||"img/icons.png"),!!P[W])?[3,4]:(x=P,E=W,[4,S(W)]):[3,6];case 3:x[E]=n.sent(),n.label=4;case 4:a.clearRect(48*G[0][0],48*G[0][1],48,48),a.drawImage(P[W],48*G[1][0],48*G[1][1],48,48,48*G[0][0],48*G[0][1],48,48),n.label=5;case 5:return M++,[3,2];case 6:return q=w,_=[y],[4,j(a)];case 7:return q.apply(void 0,_.concat([n.sent()])),[2];}})})},extraColumnIcons:z,extraRowIcons:$,alias:w,aliases:N}};window.Cppkies?M=window.Cppkies:(M=Ue,window.Cppkies=M,function(){return new Promise(function(a){var t=new R,e=[new F("customMenu",function(){Game.UpdateMenu=o(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","after")}),new F("preSave",function(){Game.WriteSave=o(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new F("postSave",function(){Game.WriteSave=o(Game.WriteSave,"if (type==2 || type==3)","\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"postSave\")\n\t\t\t\t\t","before")}),new F("reset",function(){Game.Reset=o(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.constEmit(\"reset\", hard)\n\t\t\t\t\t","before")}),new F("reincarnate",function(){Game.registerHook("reincarnate",function(){return t.emit("reincarnate")})}),new F("getIcon",function(){Game.GetIcon=r(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];","// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace"],["col=18;","else if (type === \"Mouse\") col = 11;","after"]])}),new F("buildStore",function(){Game.BuildStore=o(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new F("grandmaPic",function(){Game.Objects.Grandma.art.pic=o(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new F("cps",function(){Game.CalculateGains=r(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","// Cppkies injection\n\t\t\t\t\t\tmult = Cppkies.hooks.emit(\"cpsMult\", mult);\n","before"]]),Game.registerHook("cps",function(n){return t.emit("cps",n)})}),new F("cursorFingerMult",function(){Game.Objects.Cursor.cps=o(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before")}),new F("cpc",function(){Game.mouseCps=r(Game.mouseCps,[["var num=0;","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before"],["var out","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cpcAdd\", add);\n","before"]]),Game.registerHook("cookiesPerClick",function(n){return t.emit("cpc",n)})}),new F("buildingCps",function(){Game.CalculateGains=o(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")}),new F("logic",function(){Game.registerHook("logic",function(){return t.emit("logic")})}),new F("draw",function(){Game.registerHook("draw",function(){return t.emit("draw")})}),new F("check",function(){Game.registerHook("check",function(){return t.emit("check")})}),new F("ticker",function(){Game.getNewTicker=o(Game.getNewTicker,"Game.TickerAge=Game.fps*10;","// Cppkies injection\nlist = Cppkies.hooks.emit(\"ticker\", list);\n","before")}),new F("specialPic",function(){Game.DrawSpecial=o(Game.DrawSpecial,"if (hovered || selected)","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","before"),Game.ToggleSpecialMenu=o(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","after")})];e.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Game.Loader.Load=o(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=r(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]]),Game.ToggleSpecialMenu=r(Game.ToggleSpecialMenu,[[">=5",">=Game.dragonLevels.findIndex(val => val.name === \"Krumblor, cookie hatchling\")","replace"],[">=25",">=Game.dragonLevels.findIndex(val => val.action === \"Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>\") + 1","replace"]]),Game.Objects.Cursor.buyFunction=o(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=o(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=o(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),a(t)})}().then(function(i){M.hooks=i,M.on=i.on.bind(i),Game.Notify("Cppkies loaded!","",[32,17],1.5);var e=document.createElement("div");e.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(e,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:y,load:f}),Game.Win("Third-party"),B(),Ue.onLoad.forEach(function(n){return n()}),Ue.onLoad=new Proxy(Ue.onLoad,{set:function(o,e,n){return"length"!==e&&n(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(n){return n()}),window.CPPKIES_ONLOAD=new Proxy(Ue.onLoad,{set:function(o,e,n){return"length"!==e&&n(),!0}}),P()}));var Pe=M;return Pe})}),Fe=e(function(e){(function(n,i){e.exports=i()})(_e,function(){function t(e){var n=document.createElement("div");return n.innerHTML=e.trim(),n.firstChild}function a(e){return`${"undefined"!=typeof e[2]&&""!==e[2]?"background-image:url("+e[2]+");":""}background-position:${48*-e[0]}px ${48*-e[1]}px;`}var u="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof _e?"undefined"==typeof self?{}:self:_e:window:globalThis,c=function(e,n){return n={exports:{}},e(n,n.exports),n.exports}(function(e){(function(n,i){e.exports=i()})(u,function(){function W(e,n){function i(){this.constructor=e}D(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function K(e,n,o,r){return new(o||(o=Promise))(function(t,s){function d(e){try{i(r.next(e))}catch(e){s(e)}}function c(e){try{i(r["throw"](e))}catch(e){s(e)}}function i(e){e.done?t(e.value):new o(function(n){n(e.value)}).then(d,c)}i((r=r.apply(e,n||[])).next())})}function Q(n,o){function e(e){return function(n){return r([e,n])}}function r(e){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,s&&(d=2&e[0]?s["return"]:e[0]?s["throw"]||((d=s["return"])&&d.call(s),0):s.next)&&!(d=d.call(s,e[1])).done)return d;switch((s=0,d)&&(e=[2&e[0],d.value]),e[0]){case 0:case 1:d=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,s=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if((d=c.trys,!(d=0<d.length&&d[d.length-1]))&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!d||e[1]>d[0]&&e[1]<d[3])){c.label=e[1];break}if(6===e[0]&&c.label<d[1]){c.label=d[1],d=e;break}if(d&&c.label<d[2]){c.label=d[2],c.ops.push(e);break}d[2]&&c.ops.pop(),c.trys.pop();continue;}e=o.call(n,c)}catch(n){e=[6,n],s=0}finally{t=d=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var t,s,d,a,c={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return a={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function J(){for(var e=0,n=0,o=arguments.length;n<o;n++)e+=arguments[n].length;for(var a=Array(e),r=0,n=0;n<o;n++)for(var t=arguments[n],s=0,c=t.length;s<c;s++,r++)a[r]=t[s];return a}function ee(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function ne(e,n){var i=null===n[0],o=/(?:)/;null!==n[0]&&(o="string"==typeof n[0]?new RegExp(ee(n[0]),"g"):n[0],!o.test(e)&&console.warn("Nothing to inject."));var r=/(\)[^{]*{)/,t=/(}?)$/;switch(n[2]){case"before":e=i?e.replace(r,"$1"+n[1]):e.replace(o,""+n[1]+n[0]);break;case"replace":e=i?n[1]:e.replace(o,n[1]);break;case"after":e=i?e.replace(t,n[1]+"$1"):e.replace(o,""+n[0]+n[1]);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}return e}function ie(n,i,o,a,e){void 0===e&&(e={});var r=Function.apply(void 0,J(Object.keys(e),["return ("+ne(n.toString(),[i,o,a])+")"])).apply(void 0,Object.values(e));return r.prototype=n.prototype,r}function o(n,i,e){void 0===e&&(e={});for(var o,a=n.toString(),r=0,t=i;r<t.length;r++)o=t[r],a=ne(a,o);var s=Function.apply(void 0,J(Object.keys(e),["return ("+a+")"])).apply(void 0,Object.values(e));return s.prototype=n.prototype,s}function a(e,n){for(var i in n)e[i]=n[i]}function r(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function oe(e,n){return e.hasOwnProperty(n)}function u(e){for(var n,i=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],o="",a=0,r=i;a<r.length;a++)for(n=r[a];e>=n[0];)o+=n[1],e-=n[0];return o}function ae(e){switch(e){case"mod":return{achievements:{},buildings:{},upgrades:{}};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!");}}function g(){return{mods:{},foreign:ae("mod"),saveVer:1,dragon:ae("dragon")}}function d(){Fe.save=T=g()}function m(e){return T.foreign.buildings[e.name]||ae("building")}function i(n){var o=n.amount,r=n.bought,e=n.free,t=n.totalCookies,s=n.level,a=n.muted,d=n.minigameSave,i=n.name;T.foreign.buildings[i]={amount:o,bought:r,free:e,totalCookies:t,level:s,muted:a,minigameSave:d}}function c(e){return T.foreign.upgrades[e.name]||ae("upgrade")}function b(e){T.foreign.upgrades[e.name]={unlocked:!!e.unlocked,bought:!!e.bought}}function h(e){return T.foreign.achievements[e.name]||ae("achievement")}function e(e){T.foreign.achievements[e.name]={won:!!e.won}}function f(){"sync"!==T.dragon.level&&T.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=T.dragon.level),"sync"!==T.dragon.auras[0]&&T.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=T.dragon.auras[0]),"sync"!==T.dragon.auras[1]&&T.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=T.dragon.auras[1])}function p(){for(var e,n=0,o=Fe.customBuildings;n<o.length;n++)e=o[n],a(e,m(e));for(var t,s=0,d=Fe.customUpgrades;s<d.length;s++)t=d[s],a(t,c(t)),t.bought&&Game.CountsAsUpgradeOwned(t.pool)&&Game.UpgradesOwned++;for(var u,p=0,g=Fe.customAchievements;p<g.length;p++)u=g[p],a(u,h(u)),u.won&&Game.CountsAsAchievementOwned(u.pool)&&Game.AchievementsOwned++;f()}function s(){for(var n,o=0,a=Fe.customBuildings;o<a.length;o++)n=a[o],i(n);for(var r,t=0,s=Fe.customUpgrades;t<s.length;t++)r=s[t],b(r);for(var d,u=0,g=Fe.customAchievements;u<g.length;u++)d=g[u],e(d)}function n(e){var n=g();if("object"!=typeof e||null===e)return n;if(!oe(e,"saveVer")||"number"!=typeof e.saveVer||1<e.saveVer)return n;if(n.foreign=oe(e,"foreign")?function(n){var o=ae("mod");if("object"!=typeof n||null===n)return o;if(oe(n,"buildings")&&"object"==typeof n.buildings&&null!==n.buildings)for(var a in n.buildings){var e=n.buildings[a];if("object"==typeof e&&null!==e)for(var r in o.buildings[a]=ae("building"),e)typeof o.buildings[a][r]==typeof e[r]&&(o.buildings[a][r]=e[r])}if(oe(n,"upgrades")&&"object"==typeof n.upgrades&&null!==n.upgrades)for(var t in n.upgrades){var i=n.upgrades[t];if("object"==typeof i&&null!==i)for(var r in o.upgrades[t]=ae("upgrade"),o.upgrades[t])typeof o.upgrades[t][r]==typeof i[r]&&(o.upgrades[t][r]=i[r])}if(oe(n,"achievements")&&"object"==typeof n.achievements&&null!==n.achievements)for(var s in n.achievements){var d=n.achievements[s];if("object"==typeof d&&null!==d)for(var r in o.achievements[s]=ae("achievement"),o.achievements[s])typeof o.achievements[s][r]==typeof d[r]&&(o.achievements[s][r]=d[r])}return o}(e.foreign):ae("mod"),oe(e,"dragon")&&"object"==typeof e.dragon&&null!==e.dragon&&(oe(e.dragon,"level")&&("number"==typeof e.dragon.level||"sync"===e.dragon.level)&&(n.dragon.level=e.dragon.level),oe(e.dragon,"auras")&&e.dragon.auras instanceof Array))for(var i in e.dragon.auras){var o=e.dragon.auras[i];("number"==typeof o||"sync"===o)&&(n.dragon.auras[i]=o)}return n}function t(e){var i;try{i=JSON.parse(e)}catch(n){""!==e&&console.warn("CPPKIES: Found invalid save, creating new one..."),d()}T=Fe.save=n(i),p()}function k(){return s(),JSON.stringify(T)}function v(e,n){te[e]=n}function re(e){if(V.includes(e))throw new Error("Recursive alias");return(V.push(e),e in te)?re(te[e]):(V=[],e)}function y(e){return new Promise(function(n){var i=new Image;i.addEventListener("load",function(){n(i)}),i.crossOrigin="Anonymous",i.src=e})}function w(e){return new Promise(function(n){e.canvas.toBlob(function(e){n(URL.createObjectURL(e))})})}function A(n,o,r,i,t,s){return new Promise(function(e){r[0]instanceof Array||(r=[r]),r=r;var a={};for(var d in r)for(var c in r[d])if(r[d][c]){if(r[d][c]=r[d][c].toString().toLowerCase(),!(r[d][c]in o))throw new Error("Invalid icon name");a[r[d][c]]=[parseInt(c),parseInt(d)]}var u=document.createElement("canvas").getContext("2d"),p=new Image;p.addEventListener("load",function(){for(var n in u.canvas.width=t[0],u.canvas.height=t[1],a)u.drawImage(p,a[n][0]*i[0],a[n][1]*i[1],i[0],i[1],o[n][0]*i[0],o[n][1]*i[1],i[0],i[1]);var r,d=function(){w(u).then(e)};s&&(r=s(u)),r instanceof Promise?r.then(d):d()}),p.crossOrigin="Anonymous",p.src=n})}function C(e){return e=J(e),(void 0===e[2]||null===e[2])&&(e[2]=Fe.iconLink),e[2]=re(e[2]),e}function I(e){var n=new N,i=[new R("tooltip",function(){e.tooltip=ie(ie(e.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new R("buy",function(){e.buy=ie(e.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new R("levelUp",function(){e.levelUp=ie(e.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:e})})];i.forEach(function(e){var n;null===(n=e.func)||void 0===n?void 0:n.call(e)}),Fe.hooks.on("buildingCps",function(i){return{building:i.building,cps:Game.Objects[i.building]===e?n.emit("cps",i.cps):i.cps}}),$[e.name]=n}function L(){for(var e,n=0,i=Game.ObjectsById;n<i.length;n++)e=i[n],$[e.name]||I(e)}function j(e){return"fortune"===e.tier}function B(n){for(var i,o=1,a=1;a<=n;a++)o+=null!==(i=be[a])&&void 0!==i?i:be["default"];return 9*F(10,o)}function M(){Fe.on("getIcon",function(e){var n=e.icon,i=e.type,o=e.tier;return Fe.customTiers.forEach(function(e){e.keyName===o.toString()&&e.iconLink&&(n[2]=e.iconLink)}),{icon:n,type:i,tier:o}}),Fe.on("getIcon",function(e){var n=e.icon,i=e.type,o=e.tier;return Fe.customBuildings.forEach(function(e){e.name===i&&e.iconLink&&(n[2]=e.iconLink)}),{icon:n,tier:o,type:i}}),Fe.on("getIcon",function(e){var n=e.icon,i=e.type,o=e.tier;return void 0!==n[2]&&null!==n[2]||oe(Game.Tiers[o.toString()],"iconLink")||(n[2]=""),{icon:n,tier:o,type:i}}),Fe.on("preSave",function(){if(0!==Game.dragonAura&&(T.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(T.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof Ie&&(T.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof Ie&&(T.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Ge||Game.dragonLevel>=S)for(T.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Ge||Game.dragonLevel>=S;)Game.dragonLevel--}),Fe.on("postSave",function(){"sync"!==T.dragon.auras[0]&&Game.dragonAuras[T.dragon.auras[0]]&&(Game.dragonAura=T.dragon.auras[0]),"sync"!==T.dragon.auras[1]&&Game.dragonAuras[T.dragon.auras[1]]&&(Game.dragonAura2=T.dragon.auras[1]),"sync"!==T.dragon.level&&Game.dragonLevels[T.dragon.level]&&(Game.dragonLevel=T.dragon.level)}),Fe.on("reset",function(){T.dragon.auras=["sync","sync"],T.dragon.level="sync"}),Fe.on("specialPic",function(e){var n,i=Game.dragonLevels[Game.dragonLevel];return"dragon"===e.tab&&i instanceof Ge&&(e.pic=null!==(n=i.picLink)&&void 0!==n?n:e.pic),e})}var G,E=qe,q=Ee,O=xe,F=We,H=Be,D=function(e,n){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},D(e,n)},N=function(){function e(){this._events={}}return e.prototype.on=function(e,n){this._events[e]?this._events[e].push(n):this._events[e]=[n]},e.prototype.once=function(e,n){var i=this;this.on(e,function(o){return i.off(e,n),n(o)})},e.prototype.off=function(e,n){this._events[e].splice(this._events[e].indexOf(n),1)},e.prototype.emit=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a=i[0];this._events[n]||(this._events[n]=[]);for(var r,t=0,s=this._events[n];t<s.length;t++)r=s[t],a=r(a);return a},e.prototype.constEmit=function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];this._events[n]||(this._events[n]=[]);for(var a,r=0,t=this._events[n];r<t.length;r++)a=t[r],a(i[0])},e}(),R=function(){return function(e,n){this.value=e,this.func=n}}(),S=Game.dragonLevels.length+0,T=g(),te={},V=[],se={},Y={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},z={},Z={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},$={},_=[],de=function(g){function e(h,i,e,k,a,n,o,v,d,c){var r,y,C=this;if(Game.Objects[h])throw new Error("Can't create building, \""+h+"\" is already used as a building name");0!==k[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==a[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),C=g.call(this,h,i,e,a[1],k[0],n,0,o,v)||this,_.push(C),$[h]||I(C);var L=function(e){if(0>=parseInt(e))return"continue";var n=Game.ObjectsById[e];if(n.canvas=l("rowCanvas"+e),!n.canvas)return"continue";if(n.ctx=n.canvas.getContext("2d"),n.canvas.addEventListener("mouseover",function(){n.mouseOn=!0}),n.canvas.addEventListener("mouseout",function(){n.mouseOn=!1}),n.canvas.addEventListener("mousemove",function(e){var i=n.canvas.getBoundingClientRect();n.mousePos[0]=e.pageX-i.left,n.mousePos[1]=e.pageY-i.top}),n.minigame&&n.minigameLoaded){var i=n.minigame.save();n.minigame.launch(),n.minigame.load(i)}};for(var u in Game.ObjectsById)L(u);C.buildingLink=null!==(r=a[2])&&void 0!==r?r:Fe.buildingLink,C.iconLink=re(null!==(y=k[2])&&void 0!==y?y:Fe.iconLink),d&&(Game.foolObjects[h]=d),c&&(Game.goldenCookieBuildingBuffs[h]=c),C.iconLink&&$[C.name].on("tooltip",function(e){return C.locked?e:e.replace("background-position","background-image:url("+C.iconLink+");background-position")}),Game.BuildStore(),C.buildingLink&&Fe.hooks.on("buildStore",function(){l("productIcon"+C.id).style.backgroundImage="url("+C.buildingLink+")",l("productIconOff"+C.id).style.backgroundImage="url("+C.buildingLink+")"}),Game.BuildStore(),C.canvas=l("rowCanvas"+C.id),C.ctx=C.canvas.getContext("2d"),C.pics=[];var S=document.createElement("div");S.className="tinyProductIcon",S.id="mutedProduct"+C.id,S.style.display="none",C.buildingLink&&(S.style.backgroundImage="url("+C.buildingLink+")"),S.style.backgroundPositionX="-"+k[0]+"px",S.style.backgroundPositionY="-"+k[1]+"px",S.addEventListener("click",function(){C.mute(0),window.PlaySound(C.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(C.canvas,"mouseover",function(){C.mouseOn=!0}),window.AddEvent(C.canvas,"mouseout",function(){C.mouseOn=!1}),C.canvas.addEventListener("mousemove",function(e){var n=C.canvas.getBoundingClientRect();C.mousePos[0]=e.pageX-n.left,C.mousePos[1]=e.pageY-n.top}),l("buildingsMute").appendChild(S);var w=m(C);for(var u in w)C[u]=w[u];return Game.recalculateGains=1,C}return W(e,g),e}(Game.Object),ce=[],le=function(n){function e(o,r,e,t,a){void 0===a&&(a=function(){});var s=n.call(this,o,"function"==typeof r?"":r,"function"==typeof e?0:e,"function"==typeof t?[0,0]:C(t),a)||this;"function"==typeof r&&(s.descFunc=r),"function"==typeof e&&(s.priceFunc=e),"function"==typeof t&&(s.iconFunction=function(){return C(t())}),ce.push(s);var u=c(s);for(var p in u)s[p]=u[p];return Game.upgradesToRebuild=1,s.bought&&Game.CountsAsUpgradeOwned(s.pool)&&Game.UpgradesOwned++,s}return W(e,n),e}(Game.Upgrade),ue=function(n){function e(o,r,e,t,s,a,d){void 0===a&&(a=["Legacy"]),void 0===d&&(d=function(){});var c=n.call(this,o,r,e,t,d)||this;return c.pool="prestige",c.posX=s[0],c.posY=s[1],c.parents=a.map(function(e){return Game.Upgrades[e]||Game.UpgradesById[e]}),Game.PrestigeUpgrades.push(c),Game.UpgradePositions[c.id]=s,c}return W(e,n),e}(le),pe=function(n){function e(i,o,e,a){var t=this;return"string"==typeof e&&(e=Game.Objects[e]),t=n.call(this,i,r(e.plural)+" are <b>twice</b> as efficient.<q>"+o+"</q>",e.basePrice*Game.Tiers[a].price,Game.GetIcon(e.name,a))||this,Game.SetTier(e.name,a),t.buildingTie1=e,j(t)&&(t.order=19e3,e.fortune=t),isNaN(parseInt(a.toString()))||(a=parseInt(a.toString())),"number"==typeof a&&(t.order=100*(e.id+1)+t.id/1e3,t.order-=75*H(0,O(e.id-4,3)),8<=e.id&&(t.order-=75)),"fortune"===a&&Game.Tiers[a].upgrades.push(t),e.buyFunction.apply(e),t}return W(e,n),e}(le),ge=function(n){function e(i,o,a,t){var s=this;if(t){if(!t.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+t+"\", URL must end with .png");t=t.substring(0,t.length-4)}"string"==typeof a&&(a=Game.Objects[a]);var d=a.id-1;return 1===d?d="grandma":d+=" grandmas",s=n.call(this,i,"Grandmas are <b>twice</b> as efficient. "+r(a.plural)+" gain <b>+1% CpS</b> per "+d+".<q>"+o+"</q>",a.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,a.grandma=s,s.buildingTie=a,s.order=250+s.id/1e3,12<=a.id&&(s.order+=5),Game.GrandmaSynergies.push(s.name),t&&Fe.hooks.on("grandmaPic",function(e){return s.bought?J(e,[t]):e}),Game.Objects.Grandma.redraw(),a.buyFunction.apply(a),s}return W(e,n),e}(le),me=function(n){function e(o,a,e,t,s){var i=this;"string"==typeof e&&(e=Game.Objects[e]),"string"==typeof t&&(t=Game.Objects[t]);var d=Game.GetIcon(e.name,s);if(e.basePrice>t.basePrice){var c=e;e=t,t=c}return i=n.call(this,o,r(e.plural)+" gain <b>+5% CpS</b> per "+t.name.toLowerCase()+".<br>"+r(t.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+e.name.toLowerCase()+".<q>"+a+"</q>",(10*e.basePrice+1*t.basePrice)*Game.Tiers[s].price,d)||this,i.tier=s,i.buildingTie1=e,i.buildingTie2=t,i.order=5e3+i.id/1e3,e.synergies.push(i),t.synergies.push(i),Game.Tiers[s].upgrades.push(i),Game.RebuildUpgrades(),e.buyFunction.apply(e),i}return W(e,n),e}(le),he=[5,7,8,9,10],ke=function(n){function e(o,a,r,e){void 0===e&&(e=20);var t=this,s=Game.Objects.Cursor,d=parseInt(r.toString());return t=n.call(this,o,"Multiplies the gain from Thousand fingers by <b>"+e+"</b>.<q>"+a+"</q>",Game.Tiers[r].special||isNaN(d)?s.basePrice*Game.Tiers[r].price:F(10,he[O(d-4,he.length-1)]+3*H(d-8,0)),Game.GetIcon(s.name,r))||this,t.tier=r,t.pool="",t.order=100+t.id/1e3,Fe.on("cursorFingerMult",function(n){return t.bought?n*e:n}),Game.Tiers[r].special||isNaN(d)||Fe.buildingHooks.Cursor.on("buy",function(){s.amount>=(4===d?25:50*(d-4))&&Game.Unlock(t.name)}),"fortune"===r&&Game.Tiers[r].upgrades.push(t),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),t}return W(e,n),e}(le),be={1:5,2:4,4:4,default:3},ve=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],fe=function(n){function e(o,a,r,e,t,s){void 0===e&&(e=Game.Tiers[r].special||isNaN(parseInt(r.toString()))?null:ve[(parseInt(r.toString())-1)%(ve.length-1)]),void 0===s&&(s=Game.Tiers[r].special||isNaN(parseInt(r.toString()))?null:1===r?.5:r-1);var d=n.call(this,o,"You gain <b>more CpS</b> the more milk you have.<q>"+a+"</q>",Game.Tiers[r].special||isNaN(parseInt(r.toString()))?null!==t&&void 0!==t?t:0:B(r),Game.GetIcon("Kitten",r))||this;return d.tier=r,d.kitten=!0,d.pool="",null===e&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[r].special||isNaN(parseInt(r.toString())))&&void 0===t&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==s&&Fe.on("logic",function(){Game.milkProgress>=s&&Game.Unlock(d.name)}),d.order=2e4+d.id/1e3,null!==e&&Fe.on("rawCpsMult",function(n){var i=d.bought?1+Game.milkProgress*e*Fe.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=i,n*i}),Game.UpgradesByPool.kitten.push(d),"fortune"===r&&Game.Tiers[r].upgrades.push(d),d}return W(e,n),e}(le),ye=function(n){function e(i,o,a,e){void 0===e&&(e=1);var r=n.call(this,i,"Clicking gains <b>+"+e+"% of your CpS</b>.<q>"+o+"</q>",F(10,3+2*parseInt(a.toString())),Game.GetIcon("Mouse",a))||this;r.tier=a,r.pool="";var t=parseInt(a.toString());return r.order=150+r.id/1e3,Fe.on("cpcAdd",function(n){return r.bought?n+Game.cookiesPs*e/100:n}),Game.Tiers[a].special||isNaN(t)||Fe.on("check",function(){Game.handmadeCookies>=F(10,1+2*t)&&Game.Unlock(r.name)}),"fortune"===a&&Game.Tiers[a].upgrades.push(r),r}return W(e,n),e}(le),Ce=function(n){function e(o,r,e,t,s,a,i){var d,c=n.call(this,o,"Cookie production multiplier <b>+"+Beautify("function"==typeof s?s():s,1)+"%</b>.<q>"+r+"</q>",e,t)||this;return c.power=s,c.pool="cookie",c.order=(null!==(d=null!==i&&void 0!==i?i:Fe.cookieOrder)&&void 0!==d?d:10020)+c.id/1e3,c.unlockAt={name:o,cookies:("function"==typeof e?e():e)/20,require:null===a||void 0===a?void 0:a.require,season:null===a||void 0===a?void 0:a.season},Game.UnlockAt.push(c.unlockAt),Game.UpgradesByPool.cookie.push(c),Game.cookieUpgrades.push(c),c}return W(e,n),e}(le),we=[],Le=function(){return function(o,a,e,r,t,s,d,c,u){void 0===r&&(r=!1),void 0===t&&(t="auto"),void 0===s&&(s=null),void 0===d&&(d=null),void 0===c&&(c=null),void 0===u&&(u="auto");var p;this.name=o,this.color=e,this.special=r,this.keyName="auto"===u?r?o:(Object.keys(Game.Tiers).filter(function(e){return!isNaN(parseInt(e))}).length+1).toString():u,null===s&&(this.unlock=-1),"number"==typeof s&&(this.unlock=s),(!1===r&&null===s||"auto"===s)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof d&&(this.achievUnlock=d),(!1===r&&null===d||"auto"===d)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),c&&(this.req=c),this.price="auto"===t?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(e){return!isNaN(parseInt(e))}).length.toString()].price:t,this.iconRow=a[1],this.iconLink=re(null!==(p=a[2])&&void 0!==p?p:Fe.iconLink),Game.Tiers[this.keyName]=this,we.push(this)}}(),Se=[],je=function(n){function e(i,o,r){var e=n.call(this,i,o,C(r))||this;return a(e,h(e)),Se.push(e),e.won&&Game.CountsAsAchievementOwned(e.pool)&&Game.AchievementsOwned++,e}return W(e,n),e}(Game.Achievement),Ae=function(n){function e(i,o,a,e){void 0===e&&(e=F(10,q(1.5*Game.BankAchievements.length+2)));var r=n.call(this,i,"Bake <b>"+toFixed(e)+"</b> cookie"+(1===E(e)?"":"s")+" in one ascension."+(a?"<q>"+a+"</q>":""),o)||this;return r.treshold=e,r.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(r),r}return W(e,n),e}(je),Oe=function(n){function e(i,o,a,e){void 0===e&&(e=F(10,q(1.2*Game.BankAchievements.length)));var r=n.call(this,i,"Bake <b>"+toFixed(e)+"</b> cookie"+(1===E(e)?"":"s")+" per second."+(a?"<q>"+a+"</q>":""),o)||this;return r.treshold=e,r.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(r),r}return W(e,n),e}(je),Te=function(n){function e(o,r,e,t){var s=this,d="object"==typeof e?e:Game.Objects[e],c=null,u=-1;if(0===d.id){switch(t){case"cursor2":c=[0,6],u=2;break;case"cursor50":c=[1,6],u=50;break;default:if(0>=Game.Tiers[t].achievUnlock){console.warn("Tier has invalid unlock amount");break}u=1===t?1:2*Game.Tiers[t].achievUnlock;}Fe.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=u&&Game.Win(s.name)})}else u=Game.Tiers[t].achievUnlock;return s=n.call(this,o,"Have <b>"+u+"</b> "+(1===E(u)?d.single:d.plural)+"."+(r?"<q>"+r+"</q>":""),null!==c&&void 0!==c?c:Game.GetIcon(d.name,t))||this,Game.SetTier(d.name,"cursor2"===t||"cursor50"===t?1:t),d.tieredAchievs[t]=s,s.buildingTie=d,s.order=1e3+100*d.id+s.id/1e3,s.order-=75*H(0,O(d.id-4,3)),8<=d.id&&(s.order-=75),0===d.id&&(s.order+=50),s}return W(e,n),e}(je),Ue=function(n){function e(i,o,r,t,s){var a=this;"string"==typeof o&&(o=Game.Objects[o]);var d=[o.iconColumn,21+r,o instanceof de?o.iconLink:void 0],c=F(10,12+o.id+(null!==s&&void 0!==s?s:0)+7*(r-1));return a=n.call(this,i,"Make <b>"+toFixed(c)+"</b> cookies just from "+o.plural+"."+(t?"<q>"+t+"</q>":""),d)||this,a.order=1020+100*o.id+a.id/1e3,a.order-=75*H(0,O(o.id-4,3)),8<=o.id&&(a.order-=75),0===o.id&&(a.order+=50),o.productionAchievs.push({pow:c,achiev:a}),a}return W(e,n),e}(je),Pe=function(n){function e(i,o,a){var e=this;"string"==typeof o&&(o=Game.Objects[o]);var r=[o.iconColumn,26,o instanceof de?o.iconLink:void 0];return e=n.call(this,i,"Reach level <b>10</b> "+o.plural+"."+(a?"<q>"+a+"</q>":""),r)||this,e.order=1020+100*o.id+e.id/1e3,e.order-=75*H(0,O(o.id-4,3)),8<=o.id&&(e.order-=75),0===o.id&&(e.order+=50),o.levelAchiev10=e,e}return W(e,n),e}(je),Me=function(n){function e(i,o,a){var e=this,r=parseInt(o.toString());return e=n.call(this,i,"Make <b>"+toFixed(F(10,1+2*r))+"</b> cookies from clicking."+(a?"<q>"+a+"</q>":""),Game.GetIcon("Mouse",o))||this,e.pool="normal",e.tier=o,e.order=1e3+e.id/1e3,Game.Tiers[o].special||isNaN(r)||Fe.on("check",function(){Game.handmadeCookies>=F(10,1+2*r)&&Game.Win(e.name)}),e}return W(e,n),e}(je),Ie=function(){function e(e,n,i){this.name=e,this.desc=n,"string"==typeof i&&(i=Game.Objects[i]),this.pic=i instanceof Game.Object?C([i.iconColumn,25,i instanceof de?i.iconLink:void 0]):i,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==T.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=T.dragon.auras[0]&&(Game.dragonAura=T.dragon.auras[0]),"sync"!==T.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=T.dragon.auras[1]&&(Game.dragonAura2=T.dragon.auras[1])}return e}(),Ge=function(){function n(o,r,e,t,s,a,d){void 0===d&&(d=Game.dragonLevels.length-3),this.buy=s,this.picY=0;var c=Game.dragonLevels[d-1];this.name=null!==o&&void 0!==o?o:c.name,this.action=r,this.costStr="string"==typeof e?function(){return e}:e,this.cost=t,a?(this.pic=a[0],this.picY=a[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=a[2]):(this.pic=c.pic,c instanceof n&&(this.picY=c.picY,this.picLink=c.picLink)),Game.dragonLevels.splice(d,0,this),"sync"!==T.dragon.level&&Game.dragonLevels.length>=T.dragon.level&&(Game.dragonLevel=T.dragon.level)}return n}(),_e=function(n){function e(i,o,a){var r=this;return"string"==typeof a&&(a=Game.Objects[a]),r=n.call(this,null,"Train "+i+"<br/><small>Aura : "+o+"</small>","100 "+a.plural,function(){return 100<=a.amount},function(){return a.sacrifice(100)})||this,r}return W(e,n),e}(Ge),Re=function(){return function(n,i,o,a){if(void 0===a&&(a=!1),this.name=n,this.pic=o,this.special=a,!o.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+o+"\", the URL must end with .png!");a||(this.name="Rank "+u(Game.Milks.length+1)+" - "+n),this.pic=o.substr(0,o.length-4),C(i),this.icon=[i[0],i[1]],this.iconLink=i[2],a?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)}}(),Fe={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:$,buildingHooksById:[],hookAllBuildings:L,customBuildings:_,customUpgrades:ce,customTiers:we,save:T,onLoad:[],Building:de,Upgrade:le,TieredUpgrade:pe,Tier:Le,HeavenlyUpgrade:ue,GrandmaSynergy:ge,SynergyUpgrade:me,CursorUpgrade:ke,KittenUpgrade:fe,MouseUpgrade:ye,CookieUpgrade:Ce,Achievement:je,CpsAchievement:Oe,BankAchievement:Ae,TieredAchievement:Te,ProductionAchievement:Ue,Level10Achievement:Pe,MouseAchievement:Me,customAchievements:Se,DragonAura:Ie,DragonLevel:Ge,DragonAuraLevel:_e,Milk:Re,injectCode:ie,injectCodes:o,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(e){return Game.GetTieredCpsMult(e)*Game.magicCpS(e.name)*e.baseCps},icons:{relinkColumn:function(n,i,e,o){return void 0===o&&(o=!1),K(this,void 0,void 0,function(){var a,r,r,t,s;return Q(this,function(d){switch(d.label){case 0:for(r in void 0===e&&(!se[n]&&(se[n]=0),e=se[n]++),a={},Y)a[r]=[e,Y[r][1]];for(r in Game.Tiers)a[Game.Tiers[r].name.toLowerCase()]=a[r.toString()]=[e,Game.Tiers[r].iconRow];return t=v,s=[n],[4,A(o?re(n):n,a,i,[48,48],[48*(e+1),48*(Object.values(a).reduce(function(e,n){return H(e,n[1])},-Infinity)+1)],function(e){return new Promise(function(i){if(re(n)!==n){var o=new Image;o.addEventListener("load",function(){e.drawImage(o,0,0),i()}),o.src=re(n),o.crossOrigin="Anonymous"}else i()})})];case 1:return t.apply(void 0,s.concat([d.sent()])),[2];}})})},relinkRow:function(n,i,e,o){return void 0===o&&(o=!1),K(this,void 0,void 0,function(){var a,r,r,t,s;return Q(this,function(d){switch(d.label){case 0:for(r in void 0===e&&(!z[n]&&(z[n]=0),e=z[n]++),a={},Z)a[r]=[Z[r][0],e];for(r in Game.ObjectsById)a[Game.ObjectsById[r].single.toLowerCase()]=a[r]=[Game.ObjectsById[r].iconColumn,e];return t=v,s=[n],[4,A(o?re(n):n,a,i,[48,48],[48*(Object.values(a).reduce(function(e,n){return H(e,n[0])},-Infinity)+1),48*(e+1)],function(e){return new Promise(function(i){if(re(n)!==n){var o=new Image;o.addEventListener("load",function(){e.drawImage(o,0,0),i()}),o.src=re(n),o.crossOrigin="Anonymous"}else i()})})];case 1:return t.apply(void 0,s.concat([d.sent()])),[2];}})})},patchIconsheet:function(n,o,e){var t;return void 0===e&&(e=!0),K(this,void 0,void 0,function(){var i,s,d,c,u,p,g,m,h,k,f,C,S,j,A;return Q(this,function(a){switch(a.label){case 0:return i=document.createElement("canvas").getContext("2d"),[4,y(e?re(n):n)];case 1:for(s=a.sent(),d=[s.width,s.height],c=0,u=o;c<u.length;c++)p=u[c],48*p[0][0]>d[0]&&(d[0]=48*p[0][0]),48*p[0][1]>d[1]&&(d[1]=48*p[0][1]);i.canvas.width=d[0],i.canvas.height=d[1],i.drawImage(s,0,0),g={},m=0,h=o,a.label=2;case 2:return m<h.length?(k=h[m],f=re((null!==(t=k[1][2])&&void 0!==t?t:Fe.iconLink)||"img/icons.png"),!!g[f])?[3,4]:(C=g,S=f,[4,y(f)]):[3,6];case 3:C[S]=a.sent(),a.label=4;case 4:i.clearRect(48*k[0][0],48*k[0][1],48,48),i.drawImage(g[f],48*k[1][0],48*k[1][1],48,48,48*k[0][0],48*k[0][1],48,48),a.label=5;case 5:return m++,[3,2];case 6:return j=v,A=[n],[4,w(i)];case 7:return j.apply(void 0,A.concat([a.sent()])),[2];}})})},extraColumnIcons:Y,extraRowIcons:Z,alias:v,aliases:te}};window.Cppkies?G=window.Cppkies:(G=Fe,window.Cppkies=G,function(){return new Promise(function(e){var n=new N,i=[new R("customMenu",function(){Game.UpdateMenu=ie(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","after")}),new R("preSave",function(){Game.WriteSave=ie(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new R("postSave",function(){Game.WriteSave=ie(Game.WriteSave,"if (type==2 || type==3)","\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"postSave\")\n\t\t\t\t\t","before")}),new R("reset",function(){Game.Reset=ie(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.constEmit(\"reset\", hard)\n\t\t\t\t\t","before")}),new R("reincarnate",function(){Game.registerHook("reincarnate",function(){return n.emit("reincarnate")})}),new R("getIcon",function(){Game.GetIcon=o(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];","// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace"],["col=18;","else if (type === \"Mouse\") col = 11;","after"]])}),new R("buildStore",function(){Game.BuildStore=ie(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new R("grandmaPic",function(){Game.Objects.Grandma.art.pic=ie(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new R("cps",function(){Game.CalculateGains=o(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","// Cppkies injection\n\t\t\t\t\t\tmult = Cppkies.hooks.emit(\"cpsMult\", mult);\n","before"]]),Game.registerHook("cps",function(e){return n.emit("cps",e)})}),new R("cursorFingerMult",function(){Game.Objects.Cursor.cps=ie(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before")}),new R("cpc",function(){Game.mouseCps=o(Game.mouseCps,[["var num=0;","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before"],["var out","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cpcAdd\", add);\n","before"]]),Game.registerHook("cookiesPerClick",function(e){return n.emit("cpc",e)})}),new R("buildingCps",function(){Game.CalculateGains=ie(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")}),new R("logic",function(){Game.registerHook("logic",function(){return n.emit("logic")})}),new R("draw",function(){Game.registerHook("draw",function(){return n.emit("draw")})}),new R("check",function(){Game.registerHook("check",function(){return n.emit("check")})}),new R("ticker",function(){Game.getNewTicker=ie(Game.getNewTicker,"Game.TickerAge=Game.fps*10;","// Cppkies injection\nlist = Cppkies.hooks.emit(\"ticker\", list);\n","before")}),new R("specialPic",function(){Game.DrawSpecial=ie(Game.DrawSpecial,"if (hovered || selected)","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","before"),Game.ToggleSpecialMenu=ie(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","after")})];i.forEach(function(e){var n;null===(n=e.func)||void 0===n?void 0:n.call(e)}),Game.Loader.Load=ie(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=o(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]]),Game.ToggleSpecialMenu=o(Game.ToggleSpecialMenu,[[">=5",">=Game.dragonLevels.findIndex(val => val.name === \"Krumblor, cookie hatchling\")","replace"],[">=25",">=Game.dragonLevels.findIndex(val => val.action === \"Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>\") + 1","replace"]]),Game.Objects.Cursor.buyFunction=ie(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=ie(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=ie(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),e(n)})}().then(function(e){G.hooks=e,G.on=e.on.bind(e),Game.Notify("Cppkies loaded!","",[32,17],1.5);var n=document.createElement("div");n.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(n,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:k,load:t}),Game.Win("Third-party"),L(),Fe.onLoad.forEach(function(e){return e()}),Fe.onLoad=new Proxy(Fe.onLoad,{set:function(e,n,i){return"length"!==n&&i(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(e){return e()}),window.CPPKIES_ONLOAD=new Proxy(Fe.onLoad,{set:function(e,n,i){return"length"!==n&&i(),!0}}),M()}));var He=G;return He})});let d=[];class e{constructor(e,n,i){this.name=e,this.color=n,this.tagFunction=i,d.push([this.name,this.color,this.tagFunction])}}class b extends c.Achievement{constructor(e,n,i){super(e,n,i)}}new e("Author","#ffffff",e=>"authors"===e.pool);class g extends c.Upgrade{constructor(n,i,o,a,r){super(n,i,o,a,r)}}class h extends c.HeavenlyUpgrade{constructor(n,i,o,a,r,e,t){super(n,i,o,a,[r[0],r[1]],e,t)}}class i extends Game.buffType{constructor(e,n){super(e,n)}}class v extends h{constructor(n,i,o,a,r,e,t,s){super(n,i,o,e,a,t,s),"undefined"==typeof window.SkullyCore.pages[r]&&(window.SkullyCore.pages[r]=[]),window.SkullyCore.pages[r].push(this),"vanilla"!==r&&Game.PrestigeUpgrades.pop()}}class k extends v{constructor(n,i,o,a,r,e=[1,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"],t,s){super(n,i,0,o,r,e,t,s),this.isRift=!0,this.activateFunction=()=>{window.SkullyCore.currentPage=this.goto,Game.BuildAscendTree()},this.exclude={all:!0},this.back=r,this.noTags=!0,this.unlocked=1,this.bought=1,this.noNeuromancy=!0,this.goto=a}}new e("Rift","#9700cf",e=>"undefined"!=typeof e.isRift);class m{}class n extends m{constructor(e,n,i){super(),this._hidden=!1,this.id=e,this.icon=n,this.tooltip=i,this.index=window.SkullyCore.BarWidgets.TopBar.Bars.push(this)-1}getDiv(){window.SkullyCore.BarWidgets.TopBar.currentPos+=48;let e=t(`
        <div class="top_bar" style="left:${window.SkullyCore.BarWidgets.TopBar.currentPos}px;" id="${this.id}TopBarMenu"> 
            <div id="${this.id}TopBarMenuIcon" class="baseIcon ${"undefined"==typeof this.icon[2]?"usesIcon":""}" style="${a(this.icon)}"></div>
        </div>`);return"undefined"!=typeof this.onclick&&(e.onclick=this.onclick),"undefined"!=typeof this.tooltip&&(e.onmouseout=()=>{Game.tooltip.shouldHide=1},e.setAttribute("onmouseover",`let ${this.id}TopBarMenuTooltip = ${this.tooltip.toString()};Game.tooltip.dynamic=1;Game.tooltip.draw(this,function(){return ${this.id}TopBarMenuTooltip();},'bottom');Game.tooltip.wobble();`)),"undefined"!=typeof this.customDiv&&(e=this.customDiv(e)),this.hidden&&(e.style.display="none"),e}set hidden(e){this._hidden=e,"undefined"!=typeof this.div&&(this.div.style.display=e?"none":"block",window.SkullyCore.TopBarMenuWidget.reloadPlacement())}get hidden(){return this._hidden}static reloadPlacement(){window.SkullyCore.BarWidgets.TopBar.currentPos=12;for(let e of window.SkullyCore.BarWidgets.TopBar.Bars)!0!==e.hidden&&(window.SkullyCore.BarWidgets.TopBar.currentPos+=48,e.div.removeAttribute("style"),e.div.setAttribute("style",`left:${window.SkullyCore.BarWidgets.TopBar.currentPos}px;`))}}class o extends m{constructor(e,n,i,o){super(),this._hidden=!1,this.id=e,this.icon=n,this.building=i,this.tooltip=o,"undefined"==typeof window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building]&&(window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building]=[],window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]=-36),this.index=window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building].push(this)-1}getDiv(){window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]+=48;let e=t(`
        <div class="building_bar" style="left:${window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]}px;" id="${this.id}BuildingBarMenu"> 
            <div id="${this.id}BuildingBarMenuIcon" class="baseIcon ${"undefined"==typeof this.icon[2]?"usesIcon":""}" style="${"undefined"==typeof this.icon[2]?"":"background-image:url("+this.icon[2]+");"}background-position:${48*-this.icon[0]}px ${48*-this.icon[1]}px;"></div>
        </div>`);return"undefined"!=typeof this.onclick&&(e.onclick=this.onclick),"undefined"!=typeof this.tooltip&&(e.onmouseout=()=>{Game.tooltip.shouldHide=1},e.setAttribute("onmouseover",`let ${this.id}BuildingBarMenuTooltip = ${this.tooltip.toString()};Game.tooltip.dynamic=1;Game.tooltip.draw(this,function(){return ${this.id}BuildingBarMenuTooltip();},'bottom');Game.tooltip.wobble();`)),"undefined"!=typeof this.customDiv&&(e=this.customDiv(e)),this.hidden&&(e.style.display="none"),e}set hidden(e){this._hidden=e,"undefined"!=typeof this.div&&(this.div.style.display=e?"none":"block",this.reloadPlacement())}get hidden(){return this._hidden}reloadPlacement(){window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]=-36;for(let e of window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building])!0!==e.hidden&&(window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]+=48,e.div.removeAttribute("style"),e.div.setAttribute("style",`left:${window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]}px;`))}}const p={AdvancedAchievement:b,AdvancedHeavenlyUpgrade:h,AdvancedUpgrade:g,AuthorAchievement:class extends b{constructor(e,n,i){super(e,n,i),this.pool="authors",this.exclude={shadow:!0},this.won=1,this.noTags=!0,this.noNeuromancy=!0}},TagCondition:e,TagConditions:d,PrestigePage:class{constructor(n,i,o,a,r){this.name=n,this.id=i,this.Rift=new k("Goto "+this.name+"...","Goto a new universe of possiblities. Don't worry you can come back.",[-30,-130],this.id,"vanilla",a,o),this.VanillaRift=new k("Goto Vanilla...","Takes you back to the vanilla prestige tree.",[-30,-30],"vanilla",this.id,r)}},RiftUpgrade:k,PagedHeavenlyUpgrade:v,currentPage:"vanilla",pages:{vanilla:Game.PrestigeUpgrades},TopBarMenuWidget:n,BuildingBarMenuWidget:o,BarWidgets:{TopBar:{currentPos:12,Bars:[]},BuildingBar:{currentPos:{},Bars:{}}},Task:class extends i{constructor(e,n){super(e,n)}},ActiveTasks:[],onLoad:[],exclude:function(e,n){if("undefined"!=typeof n.exclude){if("undefined"!=typeof n.exclude.all&&!n.exclude.all)return!0;switch(e){case"total":if("undefined"!=typeof n.exclude.total&&!n.exclude.total)return!0;break;case"debug":if("undefined"!=typeof n.exclude.debug&&!n.exclude.total)return!0;break;case"prestige":if("undefined"!=typeof n.exclude.total&&!n.exclude.total)return!0;break;case"cookie":if("undefined"!=typeof n.exclude.cookie&&!n.exclude.cookie)return!0;break;case"other":if("undefined"!=typeof n.exclude.other&&!n.exclude.other)return!0;break;case"shadow":if("undefined"!=typeof n.exclude.shadow&&!n.exclude.shadow)return!0;}}else return!0;return!1},IconToStyle:a,createElementFromString:t};let f;"undefined"==typeof window.SkullyCore?(window.SkullyCore=p,f=p,c.onLoad.push(()=>{Game.UpdateMenu=c.injectCodes(Game.UpdateMenu,[[`for (var i in achievements)`,`pools.authors = "<b>Authors</b> <small>The people who made the mods you are playing with now!</small>";`,"before"]]),Game.crate=c.injectCodes(Game.crate,[[`if (neuromancy)`,`if (neuromancy && (typeof me.noNeuromancy !== "undefined" ? !me.noNeuromancy : true))`,"replace"]]),Game.crateTooltip=c.injectCodes(Game.crateTooltip,[[`var tagsStr='';`,`
            if (typeof me.noTags !== "undefined" ? me.noTags : false) tags = []
            if (typeof me.tags !== "undefined") {
                for(let i in me.tags) {
                    tags.concat(me.tags[i]);
                }
            }
            if (typeof window.SkullyCore !== "undefined") window.SkullyCore.TagConditions.forEach((element) => {
                if(typeof element[2] === "function") {
                    if(element[2](me)) tags.push(element[0], element[1]) 
                } else if (typeof element[2] === "boolean") {
                    if(element[2]) tags.push(element[0], element[1])
                } else {
                    console.warn("Malformed TagCondition")
                }
            })
            `,"before"]]),Game.UpdateMenu=c.injectCodes(Game.UpdateMenu,[[`if (me.pool=='' || me.pool=='cookie' || me.pool=='tech') upgradesTotal++;`,`if (me.pool=='' || me.pool=='cookie' || me.pool=='tech' ) {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("total", me)) {
                    upgradesTotal++
                }
            }
            `,"replace"],[`if (me.pool=='debug') hiddenUpgrades+=str2;`,`if (me.pool=='debug') { 
                // SkullyCore Inject
                if (window.SkullyCore.exclude("debug", me)) {
                    hiddenUpgrades+=str2;
                }
            }`,"replace"],[`else if (me.pool=='prestige') {prestigeUpgrades+=str2;prestigeUpgradesTotal++;}`,`else if (me.pool=='prestige') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("prestige", me)) {
                    prestigeUpgrades+=str2;
                    prestigeUpgradesTotal++;
                }
            }`,"replace"],[`else if (me.pool=='prestige') prestigeUpgradesOwned++;`,`else if (me.pool=='prestige') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("prestige", me)) {
                    prestigeUpgradesOwned++;
                }
            }`,"replace"],[`else if (me.pool=='cookie') cookieUpgrades+=str2;`,`else if (me.pool=='cookie') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("cookie", me)) {
                    cookieUpgrades+=str2;
                }
            }`,"replace"],[`else if (me.pool!='toggle' && me.pool!='unused') upgrades+=str2;`,`else if (me.pool!='toggle' && me.pool!='unused') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("other", me)) {
                    upgrades+=str2;
                }
            }`,"replace"],[`achievementsOwnedOther++;`,`if (window.SkullyCore.exclude("shadow", me)) {
                // SkullyCore Inject
                achievementsOwnedOther++;
            }`,"replace"]]),Game.BuildAscendTree=c.injectCodes(Game.BuildAscendTree,[[`for (var i in Game.PrestigeUpgrades)`,`for (var i in window.SkullyCore.pages[window.SkullyCore.currentPage])`,"replace"],[`var str='';`,`var currentHeavenlyUpgrades = window.SkullyCore.pages[window.SkullyCore.currentPage];\n`,"before"],[`Game.PrestigeUpgrades`,`currentHeavenlyUpgrades`,"replace"]]),document.getElementsByTagName("head")[0].appendChild(t(`
        <style type="text/css">
            .top_bar { 
                width:32px;
                height:32px;
                position:absolute;
                bottom:-12px;
                z-index:10000;
                filter:drop-shadow(0px 3px 2px #000);
                -webkit-filter:drop-shadow(0px 3px 2px #000);
                cursor:pointer;
            }
            .top_bar:hover {
                bottom:-10px
            }
    
            .building_bar { 
                width:32px;
                height:32px;
                position:absolute;
                bottom:-12px;
                z-index:10000;
                filter:drop-shadow(0px 3px 2px #000);
                -webkit-filter:drop-shadow(0px 3px 2px #000);
                cursor:pointer;
            }
    
            .building_bar:hover {
                bottom:-10px
            }
    
            .baseIcon {
                width:48px;
                height:48px;
                position:absolute;
                left:-8px;
                top:-8px;
            }
        </style>`));for(let e of p.onLoad)e();let e=l("comments");p.BarWidgets.TopBar.Bars.forEach(n=>{n.div=e.appendChild(n.getDiv())}),p.TopBarMenuWidget.reloadPlacement(),Game.ObjectsById.forEach(e=>{let n=l("row"+e.id);null!==n&&("undefined"==typeof p.BarWidgets.BuildingBar.Bars[e.name]&&(p.BarWidgets.BuildingBar.Bars[e.name]=[]),0<p.BarWidgets.BuildingBar.Bars[e.name].length&&(p.BarWidgets.BuildingBar.Bars[e.name].forEach(e=>{e.div=n.appendChild(e.getDiv())}),p.BarWidgets.BuildingBar.Bars[e.name][0].reloadPlacement()))})}),p.onLoad.push(()=>{new p.AuthorAchievement("Orteil & Opti","The people who made this awesome game!",[17,5,""]),new p.AuthorAchievement("TheGLander","The developer of Cppkies and the CCRepo (W.I.P) ",[3,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),new p.AuthorAchievement("TheSkullyKO","The ideas guy and artist for SkullyCore and other Skully mods",[1,0,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),new p.AuthorAchievement("Bob","The developer that made this menu for authors and hopefully will work on much more.",[2,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),console.log("SkullyCore Loaded!")})):f=window.SkullyCore;var y=f;return y})});class He extends Fe.TopBarMenuWidget{constructor(e,n,i,o,a){super(e,i),this.name=n,this.choicesFunction=o,this.choicesPick=a,this.onclick=new Function(`// The following is a moddified version of Ortiel's code btw
        let me = window.SkullyCore.BarWidgets.TopBar.Bars[${this.index}]
        Game.choiceSelectorOn=-1;
        let choices=me.choicesFunction();
        let str = "";
        if (choices.length>0)
        {
            const closeStr = "l('toggleBox').style.display='none';l('toggleBox').innerHTML='';Game.choiceSelectorOn=-1;PlaySound('snd/tick.mp3');"
            let selected = 0;
            choices.forEach((value) => {
                if (value.selected) selected=value;
            })
            Game.choiceSelectorChoices=choices;//this is a really dumb way of doing this i am so sorry
            Game.choiceSelectorSelected=selected;
            
            str=\`<div class="close" onclick="l('toggleBox').style.display='none';\${closeStr}">x</div>
            <h3>\${me.name}</h3>
            <div class="line"></div>
            <h4 id="choiceSelectedName">\${choices[selected].name}</h4>
            <div class="line"></div>\`.replace("\\n", "")

            choices.forEach((value, index) => {
                choices[index].id=index;
                choices[index].order=value.order||0;
            })

            choices.sort((a, b) => {
                if (a.order>b.order) return 1;
                else if (a.order<b.order) return -1;
                else return 0;
            });

            for (let i=0;i<choices.length;i++)
            {
                if (!choices[i]) continue;
                var id=choices[i].id;
                if (choices[i].div) str+='<div class="line"></div>';
                str+=\`<div 
                class="crate enabled\${id==selected?' highlighted':''}" 
                style="opacity:1;float:none;display:inline-block;\${window.SkullyCore.IconToStyle(choices[i].icon)}}" 
                onclick="window.SkullyCore.BarWidgets.TopBar.Bars[\${me.index}].choicesPick(\${id});\${closeStr}" 
                onMouseOut="l('choiceSelectedName').innerHTML=Game.choiceSelectorChoices[Game.choiceSelectorSelected].name;" 
                onMouseOver="l('choiceSelectedName').innerHTML=Game.choiceSelectorChoices[\${i}].name;">
                </div>\`;
            }
        }
        let toggleBox = l('toggleBox')
        toggleBox.innerHTML=str;
        toggleBox.style.display='block';
        toggleBox.focus();
        Game.tooltip.hide();
        PlaySound('snd/tick.mp3');`)}}let De={widgets:{}};Re.onLoad.push(()=>{Re.on("check",()=>{"undefined"!=typeof De&&(Game.HasAchiev("Cheated cookies taste awful")&&De.widgets.cheaterWidget.hidden&&(console.log("unlock cheated"),De.widgets.cheaterWidget.hidden=!1),Game.Has("Golden switch")&&De.widgets.goldenSwitch.hidden&&(console.log("unlock golden"),De.widgets.goldenSwitch.hidden=!1),Game.Has("Season switcher")&&De.widgets.seasonSwitcher.hidden&&(console.log("unlock season"),De.widgets.seasonSwitcher.hidden=!1),0<Game.Objects["Wizard tower"].level&&De.widgets.spellWidget.hidden&&(console.log("unlock wizard"),De.widgets.spellWidget.hidden=!1))})}),Fe.onLoad.push(()=>{De={widgets:{cheaterWidget:new Fe.TopBarMenuWidget("cheater",[10,6]),goldenSwitch:new Fe.TopBarMenuWidget("goldenSwitch",Game.Has("Golden switch [on]")?[21,10]:[20,10]),seasonSwitcher:new He("seasonSwitcher","Season Switcher",[16,6],()=>{let e=[];return Game.Upgrades["Festive biscuit"].unlocked&&!Game.Upgrades["Festive biscuit"].bought&&(e[0]={name:"Festive biscuit",icon:[12,10],order:1}),Game.Upgrades["Ghostly biscuit"].unlocked&&!Game.Upgrades["Ghostly biscuit"].bought&&(e[1]={name:"Ghostly biscuit",icon:[13,8],order:2}),Game.Upgrades["Lovesick biscuit"].unlocked&&!Game.Upgrades["Lovesick biscuit"].bought&&(e[2]={name:"Lovesick biscuit",icon:[20,3],order:3}),Game.Upgrades["Fool's biscuit"].unlocked&&!Game.Upgrades["Fool's biscuit"].bought&&(e[3]={name:"Fool's biscuit",icon:[17,6],order:4}),Game.Upgrades["Bunny biscuit"].unlocked&&!Game.Upgrades["Bunny biscuit"].bought&&(e[4]={name:"Bunny biscuit",icon:[0,12],order:5}),e},e=>{0===e?Game.Upgrades["Festive biscuit"].buy(!1):1===e?Game.Upgrades["Ghostly biscuit"].buy(!1):2===e?Game.Upgrades["Lovesick biscuit"].buy(!1):3===e?Game.Upgrades["Fool's biscuit"].buy(!1):4===e?Game.Upgrades["Bunny biscuit"].buy(!1):void 0}),spellWidget:new He("wizardWidget","Spell Selector",[22,11],()=>{let e=[];return e[0]={name:"Conjure Baked Goods",icon:[21,11],order:1},e[1]={name:"Force the Hand of Fate",icon:[22,11],order:1},e[2]={name:"Stretch Time",icon:[23,11],order:1},e[3]={name:"Spontaneous Edifice",icon:[24,11],order:1},e[4]={name:"Haggler's Charm",icon:[25,11],order:1},e[5]={name:"Summon Crafty Pixies",icon:[26,11],order:1},e[6]={name:"Gambler's Fever Dream",icon:[27,11],order:1},e[7]={name:"Resurrect Abomination",icon:[28,11],order:1},e[8]={name:"Diminish Ineptitude",icon:[29,11],order:1},e},e=>{0===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["conjure baked goods"]):1===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["hand of fate"]):2===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["stretch time"]):3===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["spontaneous edifice"]):4===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["haggler's charm"]):5===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["summon crafty pixies"]):6===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["gambler's fever dream"]):7===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["resurrect abomination"]):8===e?Game.Objects["Wizard tower"].minigame.castSpell(Game.Objects["Wizard tower"].minigame.spells["diminish ineptitude"]):void 0}),shimmeringWidget:new Fe.TopBarMenuWidget("shimmeringWidget",Game.Has("Golden switch [on]")?[21,10]:[20,10])}},De.widgets.cheaterWidget.hidden=!0,De.widgets.cheaterWidget.onclick=()=>{Game.RuinTheFun(!0),Game.Win("Cheated cookies taste awful")},De.widgets.goldenSwitch.hidden=!0,De.widgets.goldenSwitch.onclick=new Function(`if (Game.Upgrades["Golden switch [off]"].unlocked && !Game.Upgrades["Golden switch [off]"].bought) {
		console.log("hi [off]")
		if (Game.Upgrades["Golden switch [off]"].buy()) {
			window.SkullyCore.BarWidgets.TopBar.Bars[${De.widgets.goldenSwitch.index}].div.children[0].setAttribute("style", "${Fe.IconToStyle([21,10])}")
		}
	} else if (Game.Upgrades["Golden switch [on]"].unlocked && !Game.Upgrades["Golden switch [on]"].bought) {
		console.log("hi [on]")
		if (Game.Upgrades["Golden switch [on]"].buy()) {
			window.SkullyCore.BarWidgets.TopBar.Bars[${De.widgets.goldenSwitch.index}].div.children[0].setAttribute("style", "${Fe.IconToStyle([20,10])}")
		}
	}`),De.widgets.seasonSwitcher.hidden=!0,De.widgets.spellWidget.hidden=!0})});
//# sourceMappingURL=index.js.map
